!function(m){"use strict";var s,c,n="18.01",o="javascript_native_web",r=!1,d=!1,a="/i",l=500,u=1e3,f=[],p=[],g=[],_={},h=[],v=null,y=!0,e=0,w=null,b=0,t=0,k=0,x=60,L=20,i=0,E=60,O=10,C=0,T=!0,S=!1,N={},M={},B=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,A=/(CountlySiteBot|nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO)/,H=!0;m.features=["sessions","events","views","scrolls","clicks","forms","crashes","attribution","users","star-rating"];for(var I,q={},P=0;P<m.features.length;P++)q[m.features[P]]={};m.init=function(e,t){if(!r&&(c=U(),r=!0,f=le("cly_queue")||[],_={},p=le("cly_event")||[],l=(e=e||{}).interval||m.interval||l,u=e.queue_size||m.queue_size||u,x=e.fail_timeout||m.fail_timeout||x,L=e.inactivity_time||m.inactivity_time||L,E=e.session_update||m.session_update||E,O=e.max_events||m.max_events||O,m.ignore_prefetch=e.ignore_prefetch||m.ignore_prefetch||!0,m.debug=e.debug||m.debug||!1,m.app_key=e.app_key||m.app_key||null,m.device_id=e.device_id||m.device_id||F(),m.url=ee(e.url||m.url||""),m.app_version=e.app_version||m.app_version||"0.0",m.country_code=e.country_code||m.country_code||null,m.city=e.city||m.city||null,m.ip_address=e.ip_address||m.ip_address||null,m.ignore_bots=e.ignore_bots||m.ignore_bots||!0,m.force_post=e.force_post||m.force_post||!1,m.q=m.q||[],m.onload=m.onload||[],m.ignore_visitor=e.ignore_visitor||m.ignore_visitor||!1,m.require_consent=e.require_consent||m.require_consent||!1,e.ignore_referrers&&e.ignore_referrers.constructor===Array?h=e.ignore_referrers:m.ignore_referrers&&m.ignore_referrers.constructor===Array&&(h=m.ignore_referrers),""===m.url&&(W("Please provide server URL"),m.ignore_visitor=!0),le("cly_ignore")&&(m.ignore_visitor=!0),m.ignore_prefetch&&void 0!==document.visibilityState&&"prerender"===document.visibilityState&&(m.ignore_visitor=!0),m.ignore_bots&&A.test(navigator.userAgent)&&(m.ignore_visitor=!0),window.name&&0===window.name.indexOf("cly:")?m.passed_data=JSON.parse(window.name.replace("cly:","")):location.hash&&0===location.hash.indexOf("#cly:")&&(m.passed_data=JSON.parse(location.hash.replace("#cly:",""))),m.passed_data&&m.passed_data.token&&m.passed_data.purpose&&(m.passed_data.token!=le("cly_old_token")&&(ce(m.passed_data.token),le("cly_old_token",m.passed_data.token)),"heatmap"===m.passed_data.purpose&&(m.ignore_visitor=!0,fe(),ue(m.url+"/views/heatmap.js",pe))),!m.ignore_visitor)){W("Countly initialized"),m.onload.constructor!==Array&&(m.onload=[]),m.q.constructor!==Array&&(m.q=[]),j(),le("cly_id",m.device_id);var n=0;if(location.search){var o=location.search.substring(1).split("&");for(n=0;n<o.length;n++){var i=o[n].split("=");"cly_id"==i[0]?le("cly_cmp_id",i[1]):"cly_uid"==i[0]&&le("cly_cmp_uid",i[1])}}if(void 0!==m.onload&&0<m.onload.length){for(n=0;n<m.onload.length;n++)"function"==typeof m.onload[n]&&m.onload[n]();m.onload=[]}}},m.group_features=function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&({},q[t]?W("Feature name "+t+" is already reserved"):"string"==typeof e[t]?q[t]={features:[e[t]]}:e[t]&&e[t].constructor===Array&&e[t].length?q[t]={features:e[t]}:W("Incorrect feature list for "+t+" value: "+e[t]));else W("Incorrect features: "+e)},m.check_consent=function(e){return!m.require_consent||(q[e]?!(!q[e]||!q[e].optin):(W("No feature available for "+e),!1))},m.add_consent=function(e){if(W("Adding consent for "+e),e.constructor===Array)for(var t=0;t<e.length;t++)m.add_consent(e[t]);else q[e]?q[e].features?(q[e].optin=!0,m.add_consent(q[e].features)):!0!==q[e].optin&&(N[e]=!0,q[e].optin=!0,z(),"sessions"===e&&M.begin_session?(m.begin_session.apply(m,M.begin_session),M.begin_session=null):"views"===e&&M.track_pageview&&(w=null,m.track_pageview.apply(m,M.track_pageview),M.track_pageview=null)):W("No feature available for "+e)},m.remove_consent=function(e){if(W("Removing consent for "+e),e.constructor===Array)for(var t=0;t<e.length;t++)m.remove_consent(e[t]);else q[e]?(q[e].features?m.remove_consent(q[e].features):!1!==q[e].optin&&(N[e]=!1,z()),q[e].optin=!1):W("No feature available for "+e)};var z=function(){I&&(clearTimeout(I),I=null),I=setTimeout(function(){de(N)&&(Y({consent:JSON.stringify(N)}),N={})},1e3)};function J(e){if(e.key){e.count||(e.count=1);var t=te(e,["key","count","sum","dur","segmentation"]);t.timestamp=V();var n=new Date;t.hour=n.getHours(),t.dow=n.getDay(),p.push(t),le("cly_event",p),W("Adding event: ",e)}else W("Event must have key property")}m.begin_session=function(e){if(m.check_consent("sessions")){if(!d){W("Session started"),s=U(),d=!0,y=!e;var t={begin_session:1};t.metrics=JSON.stringify($()),Y(t)}}else M.begin_session=arguments},m.session_duration=function(e){m.check_consent("sessions")&&d&&(W("Session extended",e),Y({session_duration:e}))},m.end_session=function(e){m.check_consent("sessions")&&d&&(e=e||U()-s,W("Ending session"),X(),d=!1,Y({end_session:1,session_duration:e}))},m.change_id=function(e,t){if(m.device_id!=e){t||(m.end_session(),_={});var n=m.device_id;m.device_id=e,le("cly_id",m.device_id),W("Changing id"),t?Y({old_device_id:n}):m.begin_session(!y)}},m.add_event=function(e){m.check_consent("events")&&J(e)},m.start_event=function(e){_[e]?W("Timed event with key "+e+" already started"):_[e]=U()},m.end_event=function(e){"string"==typeof e&&(e={key:e}),e.key?_[e.key]?(e.dur=U()-_[e.key],m.add_event(e),delete _[e.key]):W("Timed event with key "+e.key+" was not started"):W("Event must have key property")},m.user_details=function(e){if(m.check_consent("users")){W("Adding userdetails: ",e);Y({user_details:JSON.stringify(te(e,["name","username","email","organization","phone","picture","gender","byear","custom"]))})}},m.report_conversion=function(e,t){m.check_consent("attribution")&&(e=e||le("cly_cmp_id")||"cly_organic",t=t||le("cly_cmp_uid"),e&&t?Y({campaign_id:e,campaign_user:t}):e&&Y({campaign_id:e}))};var R={},D=function(e,t,n){m.check_consent("users")&&(R[e]||(R[e]={}),"$push"==n||"$pull"==n||"$addToSet"==n?(R[e][n]||(R[e][n]=[]),R[e][n].push(t)):R[e][n]=t)};function X(){if(w){var e={name:w,segment:void 0};m.check_consent("views")&&J({key:"[CLY]_view",dur:U()-b,segmentation:e}),w=null}}function Y(e){if(!m.ignore_visitor)if(m.app_key&&m.device_id){e.app_key=m.app_key,e.device_id=m.device_id,e.sdk_name=o,e.sdk_version=n,m.country_code&&(e.country_code=m.country_code),m.city&&(e.city=m.city),null!==m.ip_address&&(e.ip_address=m.ip_address),e.timestamp=V();var t=new Date;e.hour=t.getHours(),e.dow=t.getDay(),f.length>u&&f.shift(),f.push(e),le("cly_queue",f,!0)}else W("app_key or device_id is missing")}function j(){if(m.ignore_visitor)S=!1;else{S=!0;var e=0;if(void 0!==m.onload&&0<m.onload.length){for(e=0;e<m.onload.length;e++)"function"==typeof m.onload[e]&&m.onload[e]();m.onload=[]}if(void 0!==m.q&&0<m.q.length){var t,n=m.q;for(m.q=[],e=0;e<n.length;e++)if(W("Processing queued call",t=n[e]),"function"==typeof t)t();else if(t.constructor===Array&&0<t.length)if(void 0!==m[t[0]])m[t[0]].apply(null,t.slice(1));else{var o=t[0].replace("userData.","");void 0!==m.userData[o]&&m.userData[o].apply(null,t.slice(1))}}if(d&&y&&H){var i=U();E<i-s&&(m.session_duration(i-s),s=i)}if(0<p.length){if(p.length<=O)Y({events:JSON.stringify(p)}),p=[];else{var r=p.splice(0,O);Y({events:JSON.stringify(r)})}le("cly_event",p)}if(0<f.length&&T&&U()>k){T=!1;var a=f.shift();de(N)&&(I&&(clearTimeout(I),I=null),a.consent=JSON.stringify(N),N={}),W("Processing request",a),Q(a,function(e,t){W("Request Finished",t,e),e&&(f.unshift(t),k=U()+x),le("cly_queue",f,!0),T=!0})}setTimeout(j,l)}}function F(){return le("cly_id")||G()}function G(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16||0;return n=Math.floor(n/16),("x"==e?t:t?3:8).toString(16)})}function $(){var e={};if(e._app_version=m.app_version,e._ua=navigator.userAgent,screen.width){var t=screen.width?parseInt(screen.width):0,n=screen.height?parseInt(screen.height):0;if(0!==t&&0!==n){if(!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio)t=Math.round(t*window.devicePixelRatio),n=Math.round(n*window.devicePixelRatio);else if(90===Math.abs(window.orientation)){var o=t;t=n,n=o}e._resolution=t+"x"+n}}window.devicePixelRatio&&(e._density=window.devicePixelRatio);var i=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;if(void 0!==i&&(e._locale=i),void 0!==document.referrer&&document.referrer.length){var r=B.exec(document.referrer);if(r&&r[11]&&r[11]!=window.location.hostname){var a=!1;if(h&&h.length)for(var s=0;s<h.length;s++)try{if(new RegExp(h[s]).test(document.referrer)){W("Ignored:",document.referrer),a=!0;break}}catch(e){}a||(e._store=document.referrer)}}return W("Got metrics",e),e}function W(){m.debug&&"undefined"!=typeof console&&(arguments[1]&&"object"==typeof arguments[1]&&(arguments[1]=JSON.stringify(arguments[1])),console.log(Array.prototype.slice.call(arguments).join("\n")))}function U(){return Math.floor((new Date).getTime()/1e3)}function V(){var e=(new Date).getTime();return e<=C?C++:C=e,C}function K(e,t,n){if(m.check_consent("crashes")&&e){n=n||v;var o="";"object"==typeof e?void 0!==e.stack?o=e.stack:(void 0!==e.name&&(o+=e.name+":"),void 0!==e.message&&(o+=e.message+"\n"),void 0!==e.fileName&&(o+="in "+e.fileName+"\n"),void 0!==e.lineNumber&&(o+="on "+e.lineNumber),void 0!==e.columnNumber&&(o+=":"+e.columnNumber)):o=e+"",t=!!t;var i=$(),r={_resolution:i._resolution,_error:o,_app_version:i._app_version,_run:U()-c,_not_os_specific:!0},a=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;a&&(r._bat=Math.floor(100*a.level)),void 0!==navigator.onLine&&(r._online=!!navigator.onLine),r._background=!document.hasFocus(),0<g.length&&(r._logs=g.join("\n")),g=[],r._nonfatal=t,r._view=(window.location.pathname||"")+(window.location.search||"")+(window.location.hash||""),void 0!==n&&(r._custom=n);try{var s=document.createElement("canvas").getContext("experimental-webgl");r._opengl=s.getParameter(s.VERSION)}catch(e){}Y({crash:JSON.stringify(r)})}}function Q(t,n){try{W("Sending XML HTTP request");var e=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null,o=Z(t),i="GET";2e3<=o.length?i="POST":m.force_post&&(i="POST"),"GET"===i?e.open("GET",m.url+a+"?"+o,!0):(e.open("POST",m.url+a,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded")),e.onreadystatechange=function(){4===this.readyState&&200<=this.status&&this.status<300?"function"==typeof n&&n(!1,t):4===this.readyState&&(W("Failed Server XML HTTP request",this.status),"function"==typeof n&&n(!0,t))},"GET"==i?e.send():e.send(o)}catch(e){W("Failed XML HTTP request",e),"function"==typeof n&&n(!0,t)}}function Z(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}function ee(e){return"/"==e.substr(e.length-1)?e.substr(0,e.length-1):e}function te(e,t){for(var n,o={},i=0;i<t.length;i++)void 0!==e[n=t[i]]&&(o[n]=e[n]);return o}m.userData={set:function(e,t){R[e]=t},set_once:function(e,t){D(e,1,"$setOnce")},increment:function(e){D(e,1,"$inc")},increment_by:function(e,t){D(e,t,"$inc")},multiply:function(e,t){D(e,t,"$mul")},max:function(e,t){D(e,t,"$max")},min:function(e,t){D(e,t,"$min")},push:function(e,t){D(e,t,"$push")},push_unique:function(e,t){D(e,t,"$addToSet")},pull:function(e,t){D(e,t,"$pull")},save:function(){m.check_consent("users")&&Y({user_details:JSON.stringify({custom:R})}),R={}}},m.track_errors=function(e){v=e,window.onerror=function(e,t,n,o,i){if(void 0!==i)K(i,!1);else{var r="";void 0!==e&&(r+=e+"\n"),void 0!==t&&(r+="at "+t),void 0!==n&&(r+=":"+n),void 0!==(o=o||window.event&&window.event.errorCharacter)&&(r+=":"+o),r+="\n";try{for(var a=[],s=arguments.callee.caller;s;)a.push(s.name),s=s.caller;r+=a.join("\n")}catch(e){}K(r,!1)}}},m.log_error=function(e,t){K(e,!0,t)},m.add_log=function(e){m.check_consent("crashes")&&g.push(e)},m.stop_time=function(){H&&(H=!1,e=U()-s,t=U()-b)},m.start_time=function(){H||(H=!0,s=U()-e,b=U()-t,t=0)},m.track_sessions=function(){m.begin_session(),m.start_time(),ne(window,"beforeunload",function(){m.end_session()}),ne(window,"unload",function(){m.end_session()});var e="hidden";function t(){document[e]?m.stop_time():m.start_time()}function n(){L<=i&&m.start_time(),i=0}e in document?document.addEventListener("visibilitychange",t):(e="mozHidden")in document?document.addEventListener("mozvisibilitychange",t):(e="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",t):(e="msHidden")in document?document.addEventListener("msvisibilitychange",t):"onfocusin"in document?(ne(window,"focusin",function(){m.start_time()}),ne(window,"focusout",function(){m.stop_time()})):(ne(window,"focus",function(){m.start_time()}),ne(window,"blur",function(){m.stop_time()}),ne(window,"pageshow",function(){m.start_time()}),ne(window,"pagehide",function(){m.stop_time()})),ne(window,"mousemove",n),ne(window,"click",n),ne(window,"keydown",n),ne(window,"scroll",n),setInterval(function(){L<=++i&&m.stop_time()},6e4)},m.track_pageview=function(e,t){if(X(),e&&e.constructor===Array&&(t=e,e=null),e=e||window.location.pathname,t&&t.length)for(var n=0;n<t.length;n++)try{if(new RegExp(t[n]).test(e))return void W("Ignored:",e)}catch(e){}w=e,b=U();var o={name:e,visit:1,domain:window.location.hostname};if(void 0!==document.referrer&&document.referrer.length){var i=B.exec(document.referrer);i&&i[11]&&i[11]!=window.location.hostname&&(o.start=1)}m.check_consent("views")?J({key:"[CLY]_view",segmentation:o}):M.track_pageview=arguments},m.track_view=function(e,t){m.track_pageview(e,t)},m.track_clicks=function(e){e=e||document;var o=!0;ne(e,"click",function(e){if(o){if(o=!1,ie(e),void 0!==e.pageX&&void 0!==e.pageY){var t=re(),n=ae();m.check_consent("clicks")&&J({key:"[CLY]_action",segmentation:{type:"click",x:e.pageX,y:e.pageY,width:n,height:t,domain:window.location.hostname,view:window.location.pathname}})}setTimeout(function(){o=!0},1e3)}})},m.track_scrolls=function(e){e=e||window;var i=!0,r=0;function t(e){if(i){i=!1;var t=re(),n=ae(),o=se();m.check_consent("scrolls")&&J({key:"[CLY]_action",segmentation:{type:"scroll",y:r+o,width:n,height:t,domain:window.location.hostname,view:window.location.pathname}})}}ne(e,"scroll",function(e){r=Math.max(r,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)}),ne(e,"beforeunload",t),ne(e,"unload",t)},m.track_links=function(e){e=e||document,ne(e,"click",function(e){var t=oe(e).closest("a");t&&(ie(e),m.check_consent("clicks")&&J({key:"linkClick",segmentation:{href:t.href,text:t.innerText,id:t.id,x:e.pageX,y:e.pageY,view:window.location.pathname}}),void 0===t.href||"_blank"===t.target||e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||0!==t.href.replace(window.location.href.split("#")[0],"").indexOf("#")&&m.end_session())})},m.track_forms=function(e){function c(e){return e.name||e.id||e.type||e.nodeName}e=e||document,ne(e,"submit",function(e){var t,n=oe(e),o={id:n.id,name:n.name,action:n.action,method:n.method,view:window.location.pathname};if(void 0!==n.elements){for(var i=0;i<n.elements.length;i++)if((t=n.elements[i])&&"password"!=t.type)if(void 0===o["input:"+c(t)]&&(o["input:"+c(t)]=[]),"select"==t.nodeName.toLowerCase())if(void 0!==t.multiple){var r=[];if(void 0!==t.options)for(var a=0;a<t.options.length;a++)t.options[a].selected&&r.push(t.options[a].value);o["input:"+c(t)].push(r.join(", "))}else o["input:"+c(t)].push(t.options[t.selectedIndex].value);else"input"==t.nodeName.toLowerCase()?void 0===t.type||"checkbox"!=t.type.toLowerCase()&&"radio"!=t.type.toLowerCase()?o["input:"+c(t)].push(t.value):t.checked&&o["input:"+c(t)].push(t.value):"textarea"==t.nodeName.toLowerCase()?o["input:"+c(t)].push(t.value):void 0!==t.value&&o["input:"+c(t)].push(t.value);for(var s in o)void 0!==o[s].join&&(o[s]=o[s].join(", "))}m.check_consent("forms")&&J({key:"formSubmit",segmentation:o}),m.end_session()})},m.collect_from_forms=function(f,p){f=f||document,ne(f,"submit",function(e){var t,n=oe(e),o={},i=!1;if(void 0!==n.elements){var r,a,s={},c=f.getElementsByTagName("LABEL");for(r=0;r<c.length;r++)c[r].htmlFor&&""!==c[r].htmlFor&&(s[c[r].htmlFor]=c[r].innerText||c[r].textContent||c[r].innerHTML);for(r=0;r<n.elements.length;r++)if((t=n.elements[r])&&"password"!=t.type&&-1==t.className.indexOf("cly_user_ignore")){var d="";if("select"==t.nodeName.toLowerCase())if(void 0!==t.multiple){var l=[];if(void 0!==t.options)for(a=0;a<t.options.length;a++)t.options[a].selected&&l.push(t.options[a].value);d=l.join(", ")}else d=t.options[t.selectedIndex].value;else"input"==t.nodeName.toLowerCase()?void 0===t.type||"checkbox"!=t.type.toLowerCase()&&"radio"!=t.type.toLowerCase()?d=t.value:t.checked&&(d=t.value):"textarea"==t.nodeName.toLowerCase()?d=t.value:void 0!==t.value&&(d=t.value);if(t.className&&-1!=t.className.indexOf("cly_user_")){var u=t.className.split(" ");for(a=0;a<u.length;a++)if(0===u[a].indexOf("cly_user_")){o[u[a].replace("cly_user_","")]=d,i=!0;break}}else t.type&&"email"==t.type.toLowerCase()||t.name&&-1!=t.name.toLowerCase().indexOf("email")||t.id&&-1!=t.id.toLowerCase().indexOf("email")||t.id&&s[t.id]&&-1!=s[t.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(d)?(o.email||(o.email=d),i=!0):t.name&&-1!=t.name.toLowerCase().indexOf("username")||t.id&&-1!=t.id.toLowerCase().indexOf("username")||t.id&&s[t.id]&&-1!=s[t.id].toLowerCase().indexOf("username")?(o.username||(o.username=d),i=!0):t.name&&(-1!=t.name.toLowerCase().indexOf("tel")||-1!=t.name.toLowerCase().indexOf("phone")||-1!=t.name.toLowerCase().indexOf("number"))||t.id&&(-1!=t.id.toLowerCase().indexOf("tel")||-1!=t.id.toLowerCase().indexOf("phone")||-1!=t.id.toLowerCase().indexOf("number"))||t.id&&s[t.id]&&(-1!=s[t.id].toLowerCase().indexOf("tel")||-1!=s[t.id].toLowerCase().indexOf("phone")||-1!=s[t.id].toLowerCase().indexOf("number"))?(o.phone||(o.phone=d),i=!0):t.name&&(-1!=t.name.toLowerCase().indexOf("org")||-1!=t.name.toLowerCase().indexOf("company"))||t.id&&(-1!=t.id.toLowerCase().indexOf("org")||-1!=t.id.toLowerCase().indexOf("company"))||t.id&&s[t.id]&&(-1!=s[t.id].toLowerCase().indexOf("org")||-1!=s[t.id].toLowerCase().indexOf("company"))?(o.organization||(o.organization=d),i=!0):(t.name&&-1!=t.name.toLowerCase().indexOf("name")||t.id&&-1!=t.id.toLowerCase().indexOf("name")||t.id&&s[t.id]&&-1!=s[t.id].toLowerCase().indexOf("name"))&&(o.name||(o.name=""),o.name+=d+" ",i=!0)}}i&&(W("Gathered user data",o),p?m.user_details({custom:o}):m.user_details(o)),m.end_session()})},m.collect_from_facebook=function(s){FB&&FB.api&&FB.api("/me",function(e){var t={};if(e.name&&(t.name=e.name),e.email&&(t.email=e.email),"male"==e.gender?t.gender="M":"female"==e.gender&&(t.gender="F"),e.birthday){var n=e.birthday.split("/").pop();n&&4==n.length&&(t.byear=n)}if(e.work&&e.work[0]&&e.work[0].employer&&e.work[0].employer.name&&(t.organization=e.work[0].employer.name),s)for(var o in t.custom={},s)if(s.hasOwnProperty(o)){for(var i=s[o].split("."),r=e,a=0;a<i.length&&void 0!==(r=r[i[a]]);a++);void 0!==r&&(t.custom[o]=r)}m.user_details(t)})},m.opt_out=function(){m.ignore_visitor=!0,le("cly_ignore",!0)},m.opt_in=function(){le("cly_ignore",!1),m.ignore_visitor=!1,m.ignore_prefetch&&void 0!==document.visibilityState&&"prerender"===document.visibilityState&&(m.ignore_visitor=!0),m.ignore_bots&&A.test(navigator.userAgent)&&(m.ignore_visitor=!0),m.ignore_visitor||S||j()},m.show_feedback_popup=function(e){var t=new XMLHttpRequest;t.open("GET",m.url+"/o/web-feedback/widget?app_key="+m.app_key+"&widget_id="+e),t.onload=function(){if(200===t.status){var e=JSON.parse(t.responseText);document.body.innerHTML+='<div id="cfbg"></div><div class="countly-iframe-wrapper" id="countly-iframe-wrapper-'+e._id+'"><span class="countly-feedback-close-icon" id="countly-feedback-close-icon-'+e._id+'">×</span><iframe name="countly-feedback-iframe" id="countly-feedback-iframe" src="'+m.url+"/feedback?widget_id="+e._id+"&app_key="+m.app_key+"&url="+m.url+'"></iframe></div>',ne(document.getElementById("countly-feedback-close-icon-"+e._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+e._id).style.display="none",document.getElementById("cfbg").style.display="none"}),document.getElementById("countly-iframe-wrapper-"+e._id).style.display="block",document.getElementById("cfbg").style.display="block"}else console.log("Widget couldn't loaded.")},t.send()},Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;for(e=e.toUpperCase();t;){if(t.nodeName.toUpperCase()==e)return t;t=t.parentElement}});var ne=function(e,t,n){void 0!==e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},oe=function(e){return e?void 0!==e.target?e.target:e.srcElement:window.event.srcElement};function ie(e){return void 0===e.pageY&&"number"==typeof e.clientX&&document.documentElement&&(e.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),e}function re(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function ae(){var e=document;return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function se(){var e=document;return Math.min(Math.min(e.body.clientHeight,e.documentElement.clientHeight),Math.min(e.body.offsetHeight,e.documentElement.offsetHeight),window.innerHeight)}function ce(e){le("cly_token",e)}function de(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!0;return!1}var le=function(e,t,n){n=n||!1;var o,i=!1;i=!0;try{"undefined"!=typeof localStorage&&localStorage.setItem("testLocal",!0)}catch(e){i=!1}if(null!=t&&("object"==typeof t&&(t=JSON.stringify(t)),i?localStorage.setItem(e,t):n||r(e,t,30)),void 0===t){i?o=localStorage.getItem(e):n||(o=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0,i=n.length;o<i;o++){for(var r=n[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}(e));try{o=JSON.parse(o)}catch(e){}return o}function r(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="; expires="+o.toGMTString();document.cookie=e+"="+t+i+"; path=/"}null===t&&(i?localStorage.removeItem(e):n||r(e,"",-1))};function ue(e,t){var n,o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",e),t&&(o.onreadystatechange=o.onload=function(){n||t(),n=!0}),document.getElementsByTagName("head")[0].appendChild(o)}function fe(){var e=document.getElementById("cly-loader");if(!e){W("setting up loader");var t="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}",n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t)),n.appendChild(o),(e=document.createElement("div")).setAttribute("id","cly-loader"),document.body.appendChild(e)}e.style.display="block"}function pe(){var e=document.getElementById("cly-loader");e&&(e.style.display="none")}function me(n,o,i){var r=-1;!function e(t){t||++r==n.length?i&&setTimeout(i):setTimeout(o,0,n[r],e)}()}m.enable_feedback=function(e){if(document.head.innerHTML+="<style>#cfbg{display:none;position:absolute;height:100%;z-index:1000;width:100%;top: 0;background-color: black;opacity: 0.5;left: 0;}.mleft,.mright{top:150px;width:22px;padding-top:10px;padding-bottom:10px}.mright{right:0;writing-mode:vertical-rl}.mleft{left:0;writing-mode:vertical-lr}.bleft,.bright{bottom:0;writing-mode:horizontal-tb;padding-right:10px;padding-left:10px;padding-top:3px}.bleft{left:15%}.bright{right:15%}@media screen and (max-device-width:414px){#countly-feedback-iframe{width:100%;height:600px;border:none;background:0 0}.countly-iframe-wrapper{z-index:2000;box-shadow: 0 10px 11px 0 rgba(0,0,0,0.06);width:95%;margin-left:1%;box-sizing:border-box;height:600px;background:0 0;position:absolute;top:100px;display:none}.countly-feedback-sticker{border-top-left-radius:2px;border-bottom-left-radius:2px;position:absolute;background-color:#13b94d;color:#fff;cursor:pointer;font-family:‘Lato’,sans-serif}.countly-feedback-close-icon{right:30px;top:15px;cursor:pointer;text-decoration:none;text-align:center;width:32px,height:3px,padding: 0;color:#d6d6d6;font-style:normal;font-size:32px;font-family:Arial,Baskerville,monospace;line-height:32px;position:absolute;z-index:9999}}@media screen and (min-device-width:414px){#countly-feedback-iframe{width:480px;height:600px;border:none;background:0 0}.countly-iframe-wrapper{z-index:2000;width:480px;height:600px;background:0 0;position:absolute;top:10%;left:calc((100% - 480px)/ 2);display:none}.countly-feedback-sticker{border-top-left-radius:2px;border-bottom-left-radius:2px;position:absolute;background-color:#13b94d;color:#fff;cursor:pointer;font-family:‘Lato’,sans-serif}.countly-feedback-close-icon{right:20px;top:15px;cursor:pointer;text-decoration:none;text-align:center;width:32px,height:3px,padding: 0;color:#d6d6d6;font-style:normal;font-size:32px;font-family:Arial,Baskerville,monospace;line-height:32px;position:absolute;z-index:9999}}</style>",0<e.widgets.length){document.body.innerHTML+='<div id="cfbg"></div>';var t=new XMLHttpRequest;t.open("GET",m.url+"/o/web-feedback/multiple-widgets-by-id?app_key="+m.app_key+"&widgets="+JSON.stringify(e.widgets)),t.onload=function(){200===t.status?me(JSON.parse(t.responseText),function(t,e){JSON.parse(t.target_pages).forEach(function(e){e!==window.location.pathname||t.hide_sticker||(document.body.innerHTML+='<div style="color:'+(t.trigger_font_color<7?"#"+t.trigger_font_color:t.trigger_font_color)+";background-color:"+(t.trigger_bg_color.length<7?"#"+t.trigger_bg_color:t.trigger_bg_color)+'" class="countly-feedback-sticker '+t.trigger_position+'" id="countly-feedback-sticker-'+t._id+'">'+t.trigger_button_text+'</div><div class="countly-iframe-wrapper" id="countly-iframe-wrapper-'+t._id+'"><span class="countly-feedback-close-icon" id="countly-feedback-close-icon-'+t._id+'">×</span><iframe name="countly-feedback-iframe" id="countly-feedback-iframe" src="'+m.url+"/feedback?widget_id="+t._id+"&app_key="+m.app_key+"&url="+m.url+'"></iframe></div>')}),JSON.parse(t.target_pages).forEach(function(e){e!==window.location.pathname||t.hide_sticker||(ne(document.getElementById("countly-feedback-sticker-"+t._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+t._id).style.display="block",document.getElementById("cfbg").style.display="block"}),ne(document.getElementById("countly-feedback-close-icon-"+t._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+t._id).style.display="none",document.getElementById("cfbg").style.display="none"}))}),e()}):console.log("Widget couldn't loaded.")},t.send()}else console.info("You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback")},m._internals={store:le,getDocWidth:ae,getDocHeight:re,getViewportHeight:se,get_page_coord:ie,get_event_target:oe,add_event:ne,getProperties:te,stripTrailingSlash:ee,prepareParams:Z,sendXmlHttpRequest:Q,recordError:K,getMsTimestamp:V,getTimestamp:U,log:W,getMetrics:$,generateUUID:G,getId:F,heartBeat:j,toRequestQueue:Y,reportViewDuration:X,loadJS:ue,loadCSS:function(e,t){var n,o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",e),t&&(o.onreadystatechange=o.onload=function(){n||t(),n=!0}),document.getElementsByTagName("head")[0].appendChild(o)},getLastView:function(){return w},setToken:ce,getToken:function(){var e=le("cly_token");return le("cly_token",null),e},showLoader:fe,hideLoader:pe,add_cly_events:J,asyncForeach:me}}(window.Countly=window.Countly||{});