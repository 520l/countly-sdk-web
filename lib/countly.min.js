(function(b){function S(){if(C){A||D();var a={name:C,segment:A};b.add_event({key:"[CLY]_view",dur:l()-E,segmentation:a});C=null}}function r(a){if(!F)if(!b.app_key||!b.device_id)m("app_key or device_id is missing");else{a.app_key=b.app_key;a.device_id=b.device_id;a.sdk_name=da;b.country_code&&(a.country_code=b.country_code);b.city&&(a.city=b.city);null!==b.ip_address&&(a.ip_address=b.ip_address);a.timestamp=l();var c=new Date;a.hour=c.getHours();a.dow=c.getDay();s.length>K&&s.shift();s.push(a);q("cly_queue",
s,!0)}}function L(){if("undefined"!==typeof b.q&&0<b.q.length){for(var a,c=0;c<b.q.length;c++)if(a=b.q[c],m("Processing queued call",a),"function"===typeof a)a();else if(a.constructor===Array&&0<a.length)if("undefined"!==typeof b[a[0]])b[a[0]].apply(null,a.slice(1));else{var f=a[0].replace("userData.","");"undefined"!==typeof b.userData[f]&&b.userData[f].apply(null,a.slice(1))}b.q=[]}x&&(T&&B)&&(a=l(),a-w>M&&(b.session_duration(a-w),w=a));0<t.length&&(t.length<=G?(r({events:JSON.stringify(t)}),t=
[]):(a=t.splice(0,G),r({events:JSON.stringify(a)})),q("cly_event",t));if(0<s.length&&N&&l()>U){N=!1;var d=s.shift();m("Processing request",d);var j=function(a,c){m("Request Finished",c,a);a&&(s.unshift(c),U=l()+O);q("cly_queue",s,!0);N=!0};try{m("Sending XML HTTP request");var h=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null,i;a=[];for(var g in d)a.push(g+"="+encodeURIComponent(d[g]));i=a.join("&");g="GET";2E3<=i.length?g="POST":b.force_post&&
(g="POST");"GET"===g?h.open("GET",b.url+V+"?"+i,!0):(h.open("POST",b.url+V,!0),h.setRequestHeader("Content-type","application/x-www-form-urlencoded"));h.onreadystatechange=function(){4===this.readyState&&200<=this.status&&300>this.status?"function"===typeof j&&j(!1,d):4===this.readyState&&(m("Failed Server XML HTTP request",this.status),"function"===typeof j&&j(!0,d))};"GET"==g?h.send():h.send(i)}catch(e){m("Failed XML HTTP request",e),"function"===typeof j&&j(!0,d)}}setTimeout(L,P)}function D(){var a=
{};a._app_version=b.app_version;screen.width&&(a._resolution=""+(screen.width?screen.width:"")+"x"+(screen.height?screen.height:""));for(var c=navigator.appVersion,f=navigator.userAgent,d=navigator.appName,j,h,i=[["Opera Mini","Opera Mini"],["Opera","Opera"],["OPR","Opera"],["MSIE","Internet Explorer"],["IEMobile","IE Mobile"],["Edge","Edge"],["CrKey","Chromecast"],["Chromium","Chromium"],["FxiOS","Firefox"],["Trident","Internet Explorer"],["FBAV/","Facebook app"],["baiduboxapp/","Baidu Box App"],
["baidubrowser/","Baidu Browser"],["Dolfin","Dolfin"],["Skyfire","Skyfire"],["bolt","Bolt"],["teashark","TeaShark"],["Blazer","Blazer"],["Tizen","Tizen"],["UCWEB","UCBrowser"],["UC.","UCBrowser"],["DiigoBrowser","DiigoBrowser"],["Puffin","Puffin"],["Mercury","Mercury"],["Obigo","ObigoBrowser"],["NF-Browser","NetFront"],["amaya","Amaya"],["Arora","Arora"],["Avant","Avant"],["BlackBerry","BlackBerry"],["RIM","BlackBerry"],["CFNetwork","CFNetwork"],["Camino","Camino"],["Coast","Coast"],["Dalvik","Dalvik"],
["Dillo","Dillo"],["DoCoMo","DoCoMo"],["ELinks","ELinks"],["Espial","Espial TV Browser"],["FlyFlow","FlyFlow"],["GSA","Google App"],["Google Desktop","Google Desktop"],["GooglePlus","Google+ App"],["IBrowse","IBrowse"],["Jasmine","Jasmine"],["Kindle","Kindle"],["Konqueror","Konqueror"],["Links","Links"],["Lotus-Notes","Lotus Notes"],["Lynx","Lynx"],["WAP","WAP Browser"],["MiuiBrowser","Miui Browser"],["Nokia","Nokia"],["OneBrowser","OneBrowser"],["Outlook","Outlook"],["Palm","Palm"],["Pinterest",
"Pinterest App"],["Playstation","Playstation"],["PlayStation","Playstation"],["PLAYSTATION","Playstation"],["Polaris","Polaris"],["QQ","QQbrowser"],["Qt","Qt"],["QuickTime","QuickTime"],["SEMC-Browser","SEMC Browser"],["SamsungBrowser","Samsung Browser"],["SeaMonkey","SeaMonkey"],["Sleipnir","Sleipnir"],["SmartTV","SmartTV WebBrowser"],["Viera","SmartViera"],["Thunderbird","Thunderbird"],["Vivaldi","Vivaldi"],["wOSBrowser","webOS"],["WebTV","WebTV"],["wp-","WordPress App"],["YaBrowser","Yandex Browser"],
["iCab","iCab"],["iTunes","iTunes"],["rekonq","rekonq"],["rekonq","rekonq"],["Chrome","Chrome"],["Firefox","Firefox"],["Android","Android"],["Safari","Safari"],["iPhone","Safari"]],g=0;g<i.length;g++)if(-1!=f.indexOf(i[g][0])){d=i[g][1];break}if(!d&&(j=f.lastIndexOf(" ")+1)<(h=f.lastIndexOf("/")))d=f.substring(j,h),d.toLowerCase()==d.toUpperCase()&&(d=navigator.appName);a._browser=d;d="unknown";j=[{s:"Xbox",r:/Xbox/},{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},
{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 10",r:/(Windows NT 10.0)/},{s:"Windows NT 4.0",
r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Windows Phone",r:/Windows Phone/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OSX",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"SearchBot",r:W}];for(var e in j)if(h=j[e],h.r.test(f)){d=h.s;break}e="unknown";
/Windows/.test(d)&&"Windows Phone"!=d&&(e=/Windows (.*)/.exec(d)[1],d="Windows");switch(d){case "Mac OSX":e=/Mac OS X (10[\.\_\d]+)/.exec(f)[1];break;case "Windows Phone":e=(/Windows Phone ([\.\_\d]+)/.exec(f)||["","8.0"])[1];break;case "Android":e=/Android ([\.\_\d]+)/.exec(f)[1];break;case "iOS":e=/OS (\d+)_(\d+)_?(\d+)?/.exec(c),e=e[1]+"."+e[2]+"."+(e[3]|0)}A=a._os=d;a._os_version=e;c=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;"undefined"!==
typeof c&&(a._locale=c);if("undefined"!==typeof document.referrer&&document.referrer.length&&(c=X.exec(document.referrer))&&c[11]&&c[11]!=window.location.hostname){c=!1;if(y&&y.length)for(f=0;f<y.length;f++)try{if(RegExp(y[f]).test(document.referrer)){m("Ignored:",document.referrer);c=!0;break}}catch(k){}c||(a._store=document.referrer)}m("Got metrics",a);return a}function m(){b.debug&&"undefined"!==typeof console&&(arguments[1]&&"object"==typeof arguments[1]&&(arguments[1]=JSON.stringify(arguments[1])),
console.log(Array.prototype.slice.call(arguments).join("\n")))}function l(){return Math.floor((new Date).getTime()/1E3)}function Q(a,c,b){var b=b||Y,d="";"object"===typeof a?"undefined"!==typeof a.stack?d=a.stack:("undefined"!==typeof a.name&&(d+=a.name+":"),"undefined"!==typeof a.message&&(d+=a.message+"\n"),"undefined"!==typeof a.fileName&&(d+="in "+a.fileName+"\n"),"undefined"!==typeof a.lineNumber&&(d+="on "+a.lineNumber),"undefined"!==typeof a.columnNumber&&(d+=":"+a.columnNumber)):d=a+"";var c=
c?!0:!1,a=D(),d={_os:a._os,_os_version:a._os_version,_resolution:a._resolution,_error:d,_app_version:a._app_version,_run:l()-Z,_not_os_specific:!0},j=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;j&&(d._bat=Math.floor(100*j.level));"undefined"!==typeof navigator.onLine&&(d._online=navigator.onLine?!0:!1);d._background=document.hasFocus()?!1:!0;0<H.length&&(d._logs=H.join("\n"));H=[];d._nonfatal=c;d._view=(window.location.pathname||"")+(window.location.search||
"")+(window.location.hash||"");d._browser=a._browser;"undefined"!==typeof b&&(d._custom=b);try{var h=document.createElement("canvas").getContext("experimental-webgl");d._opengl=h.getParameter(h.VERSION)}catch(i){}r({crash:JSON.stringify(d)})}function $(a,c){for(var b={},d,j=0;j<c.length;j++)d=c[j],"undefined"!==typeof a[d]&&(b[d]=a[d]);return b}function aa(a){"undefined"==typeof a.pageY&&("number"==typeof a.clientX&&document.documentElement)&&(a.pageX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,
a.pageY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return a}var da="javascript_native_web",ba=!1,x=!1,V="/i",P=500,K=1E3,s=[],t=[],H=[],z={},y=[],Y=null,T=!0,w,ca=0,C=null,E=0,R=0,U=0,O=60,I=20,J=0,M=60,G=10,N=!0,A,X=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,W=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO)/,
F=!1,B=!0,Z;b.init=function(a){if(!ba){Z=l();ba=!0;s=q("cly_queue")||[];z={};t=q("cly_event")||[];a=a||{};P=a.interval||b.interval||P;K=a.queue_size||b.queue_size||K;O=a.fail_timeout||b.fail_timeout||O;I=a.inactivity_time||b.inactivity_time||I;M=a.session_update||b.session_update||M;G=a.max_events||b.max_events||G;b.ignore_prefetch=a.ignore_prefetch||b.ignore_prefetch||!0;b.debug=a.debug||b.debug||!1;b.app_key=a.app_key||b.app_key||null;var c=b,f;if(!(f=a.device_id))if(!(f=b.device_id))if(!(f=q("cly_id"))){var d=
(new Date).getTime();f="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=(d+16*Math.random())%16|0;d=Math.floor(d/16);return("x"==a?c:c&3|8).toString(16)})}c.device_id=f;c=b;f=a.url||b.url||"https://cloud.count.ly";f="/"==f.substr(f.length-1)?f.substr(0,f.length-1):f;c.url=f;b.app_version=a.app_version||b.app_version||"0.0";b.country_code=a.country_code||b.country_code||null;b.city=a.city||b.city||null;b.ip_address=a.ip_address||b.ip_address||null;b.ignore_bots=a.ignore_bots||
b.ignore_bots||!0;b.force_post=a.force_post||b.force_post||!1;b.q=b.q||[];a.ignore_referrers&&a.ignore_referrers.constructor===Array?y=a.ignore_referrers:b.ignore_referrers&&b.ignore_referrers.constructor===Array&&(y=b.ignore_referrers);b.ignore_prefetch&&("undefined"!==typeof document.visibilityState&&"prerender"===document.visibilityState)&&(F=!0);b.ignore_bots&&W.test(navigator.userAgent)&&(F=!0);if(!F&&(m("Countly initialized"),b.q.constructor!==Array&&(b.q=[]),L(),q("cly_id",b.device_id),location.search)){a=
location.search.substring(1).split("&");for(c=0;c<a.length;c++)f=a[c].split("="),"cly_id"==f[0]?q("cly_cmp_id",f[1]):"cly_uid"==f[0]&&q("cly_cmp_uid",f[1])}}};b.begin_session=function(a){x||(m("Session started"),w=l(),x=!0,T=a?!1:!0,a={begin_session:1},a.metrics=JSON.stringify(D()),r(a))};b.session_duration=function(a){x&&(m("Session extended",a),r({session_duration:a}))};b.end_session=function(a){x&&(a=a||l()-w,m("Ending session"),S(),x=!1,r({end_session:1,session_duration:a}),L())};b.change_id=
function(a,c){if(b.device_id!=a){var f=b.device_id;b.device_id=a;q("cly_id",b.device_id);m("Changing id");c&&r({old_device_id:f})}};b.add_event=function(a){if(a.key){a.count||(a.count=1);var c=$(a,["key","count","sum","dur","segmentation"]);c.timestamp=l();var b=new Date;c.hour=b.getHours();c.dow=b.getDay();t.push(c);q("cly_event",t);m("Adding event: ",a)}else m("Event must have key property")};b.start_event=function(a){z[a]?m("Timed event with key "+a+" already started"):z[a]=l()};b.end_event=function(a){"string"==
typeof a&&(a={key:a});a.key?z[a.key]?(a.dur=l()-z[a.key],b.add_event(a),delete z[a.key]):m("Timed event with key "+a.key+" was not started"):m("Event must have key property")};b.user_details=function(a){m("Adding userdetails: ",a);r({user_details:JSON.stringify($(a,"name username email organization phone picture gender byear custom".split(" ")))})};b.report_conversion=function(a,c){a=a||q("cly_cmp_id")||"cly_organic";c=c||q("cly_cmp_uid");a&&c?r({campaign_id:a,campaign_user:c}):a?r({campaign_id:a}):
m("No campaign data found")};var u={},v=function(a,c,b){u[a]||(u[a]={});"$push"==b||"$pull"==b||"$addToSet"==b?(u[a][b]||(u[a][b]=[]),u[a][b].push(c)):u[a][b]=c};b.userData={set:function(a,b){u[a]=b},set_once:function(a){v(a,1,"$setOnce")},increment:function(a){v(a,1,"$inc")},increment_by:function(a,b){v(a,b,"$inc")},multiply:function(a,b){v(a,b,"$mul")},max:function(a,b){v(a,b,"$max")},min:function(a,b){v(a,b,"$min")},push:function(a,b){v(a,b,"$push")},push_unique:function(a,b){v(a,b,"$addToSet")},
pull:function(a,b){v(a,b,"$pull")},save:function(){r({user_details:JSON.stringify({custom:u})});u={}}};b.track_errors=function(a){Y=a;window.onerror=function(a,b,d,j,h){if("undefined"!==typeof h)Q(h,!1);else{var j=j||window.event&&window.event.errorCharacter,i="";"undefined"!==typeof a&&(i+=a+"\n");"undefined"!==typeof b&&(i+="at "+b);"undefined"!==typeof d&&(i+=":"+d);"undefined"!==typeof j&&(i+=":"+j);i+="\n";try{for(var g=[],e=arguments.callee.caller;e;)g.push(e.name),e=e.caller;i+=g.join("\n")}catch(m){}Q(i,
!1)}}};b.log_error=function(a,b){Q(a,!0,b)};b.add_log=function(a){H.push(a)};b.stop_time=function(){B&&(B=!1,ca=l()-w,R=l()-E)};b.start_time=function(){B||(B=!0,w=l()-ca,E=l()-R,R=0)};b.track_sessions=function(){function a(){document[f]?b.stop_time():b.start_time()}function c(){J>=I&&b.start_time();J=0}b.begin_session();b.start_time();k(window,"beforeunload",function(){b.end_session()});k(window,"unload",function(){b.end_session()});var f="hidden";f in document?document.addEventListener("visibilitychange",
a):(f="mozHidden")in document?document.addEventListener("mozvisibilitychange",a):(f="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(f="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?(k(window,"focusin",function(){b.start_time()}),k(window,"focusout",function(){b.stop_time()})):(k(window,"focus",function(){b.start_time()}),k(window,"blur",function(){b.stop_time()}),k(window,"pageshow",function(){b.start_time()}),k(window,
"pagehide",function(){b.stop_time()}));k(window,"mousemove",c);k(window,"click",c);k(window,"keydown",c);k(window,"scroll",c);setInterval(function(){J++;J>=I&&b.stop_time()},6E4)};b.track_pageview=function(a,c){S();a&&a.constructor===Array&&(c=a,a=null);a=a||window.location.pathname;if(c&&c.length)for(var f=0;f<c.length;f++)try{if(RegExp(c[f]).test(a)){m("Ignored:",a);return}}catch(d){}C=a;E=l();A||D();f={name:a,visit:1,segment:A,domain:window.location.hostname};if("undefined"!==typeof document.referrer&&
document.referrer.length){var j=X.exec(document.referrer);j&&(j[11]&&j[11]!=window.location.hostname)&&(f.start=1)}b.add_event({key:"[CLY]_view",segmentation:f})};b.track_view=function(a,c){b.track_pageview(a,c)};b.track_clicks=function(a){function c(a){if(f){f=!1;aa(a);if("undefined"!==typeof a.pageX&&"undefined"!==typeof a.pageY){var c;c=document;c=Math.max(Math.max(c.body.scrollHeight,c.documentElement.scrollHeight),Math.max(c.body.offsetHeight,c.documentElement.offsetHeight),Math.max(c.body.clientHeight,
c.documentElement.clientHeight));var h;h=document;h=Math.max(Math.max(h.body.scrollWidth,h.documentElement.scrollWidth),Math.max(h.body.offsetWidth,h.documentElement.offsetWidth),Math.max(h.body.clientWidth,h.documentElement.clientWidth));b.add_event({key:"[CLY]_action",segmentation:{type:"click",x:a.pageX,y:a.pageY,width:h,height:c,domain:window.location.hostname}})}setTimeout(function(){f=!0},1E3)}}var a=a||document,f=!0;k(a,"mousedown",c);k(a,"mouseup",c);k(a,"click",c)};b.track_links=function(a){function c(){function c(a){var f;
f=a?"undefined"!==typeof a.target?a.target:a.srcElement:window.event.srcElement;aa(a);b.add_event({key:"linkClick",segmentation:{href:f.href,text:f.innerText,id:f.id,x:a.pageX,y:a.pageY}});"undefined"!==typeof f.href&&"_blank"!==f.target&&!a.metaKey&&!a.altKey&&!a.ctrlKey&&!a.shiftKey&&0!==f.href.replace(window.location.href.split("#")[0],"").indexOf("#")&&b.end_session()}if("undefined"!==typeof a.getElementsByTagName)for(var d=a.getElementsByTagName("a"),j=0;j<d.length;j++)k(d[j],"click",c);else m("Can't track clicks")}
a=a||document;"complete"===document.readyState?c():k(window,"load",c)};b.track_forms=function(a){function c(a){return a.name||a.id||a.type||a.nodeName}function f(a){var f=!1;k(a,"submit",function(){if(!f){f=!0;var d={id:a.id,name:a.name,action:a.action,method:a.method},g;if("undefined"!==typeof a.elements)for(var e=0;e<a.elements.length;e++)if((g=a.elements[e])&&"password"!=g.type)if("undefined"===typeof d["input:"+c(g)]&&(d["input:"+c(g)]=[]),"select"==g.nodeName.toLowerCase())if("undefined"!==typeof g.multiple){var m=
[];if("undefined"!==typeof g.options)for(var n=0;n<g.options.length;n++)g.options[n].selected&&m.push(g.options[n].value);d["input:"+c(g)].push(m.join(", "))}else d["input:"+c(g)].push(g.options[g.selectedIndex].value);else"input"==g.nodeName.toLowerCase()?"undefined"!==typeof g.type?"checkbox"==g.type.toLowerCase()||"radio"==g.type.toLowerCase()?g.checked&&d["input:"+c(g)].push(g.value):d["input:"+c(g)].push(g.value):d["input:"+c(g)].push(g.value):"textarea"==g.nodeName.toLowerCase()?d["input:"+
c(g)].push(g.value):"undefined"!==typeof g.value&&d["input:"+c(g)].push(g.value);for(var k in d)"undefined"!=typeof d[k].join&&(d[k]=d[k].join(", "));b.add_event({key:"formSubmit",segmentation:d});b.end_session()}})}function d(){if("undefined"!==typeof a.getElementsByTagName)for(var b=a.getElementsByTagName("form"),c=0;c<b.length;c++)f(b[c]);else m("Can't track forms")}a=a||document;"complete"===document.readyState?d():k(window,"load",d)};b.collect_from_forms=function(a,c){function f(d){var f=!1;
k(d,"submit",function(){if(!f){f=!0;var i={},g=!1,e;if("undefined"!==typeof d.elements){var k={},n=a.getElementsByTagName("LABEL"),l;for(l=0;l<n.length;l++)n[l].htmlFor&&""!==n[l].htmlFor&&(k[n[l].htmlFor]=n[l].innerText||n[l].textContent||n[l].innerHTML);for(l=0;l<d.elements.length;l++)if((e=d.elements[l])&&"password"!=e.type&&-1==e.className.indexOf("cly_user_ignore")){var p="";if("select"==e.nodeName.toLowerCase())if("undefined"!==typeof e.multiple){p=[];if("undefined"!==typeof e.options)for(n=
0;n<e.options.length;n++)e.options[n].selected&&p.push(e.options[n].value);p=p.join(", ")}else p=e.options[e.selectedIndex].value;else"input"==e.nodeName.toLowerCase()?"undefined"!==typeof e.type?"checkbox"==e.type.toLowerCase()||"radio"==e.type.toLowerCase()?e.checked&&(p=e.value):p=e.value:p=e.value:"textarea"==e.nodeName.toLowerCase()?p=e.value:"undefined"!==typeof e.value&&(p=e.value);if(e.className&&-1!=e.className.indexOf("cly_user_")){e=e.className.split(" ");for(n=0;n<e.length;n++)if(0===
e[n].indexOf("cly_user_")){i[e[n].replace("cly_user_","")]=p;g=!0;break}}else if(e.type&&"email"==e.type.toLowerCase()||e.name&&-1!=e.name.toLowerCase().indexOf("email")||e.id&&-1!=e.id.toLowerCase().indexOf("email")||e.id&&k[e.id]&&-1!=k[e.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(p))i.email||(i.email=p),g=!0;else if(e.name&&-1!=e.name.toLowerCase().indexOf("username")||e.id&&-1!=e.id.toLowerCase().indexOf("username")||e.id&&k[e.id]&&-1!=k[e.id].toLowerCase().indexOf("username"))i.username||
(i.username=p),g=!0;else if(e.name&&(-1!=e.name.toLowerCase().indexOf("tel")||-1!=e.name.toLowerCase().indexOf("phone")||-1!=e.name.toLowerCase().indexOf("number"))||e.id&&(-1!=e.id.toLowerCase().indexOf("tel")||-1!=e.id.toLowerCase().indexOf("phone")||-1!=e.id.toLowerCase().indexOf("number"))||e.id&&k[e.id]&&(-1!=k[e.id].toLowerCase().indexOf("tel")||-1!=k[e.id].toLowerCase().indexOf("phone")||-1!=k[e.id].toLowerCase().indexOf("number")))i.phone||(i.phone=p),g=!0;else if(e.name&&(-1!=e.name.toLowerCase().indexOf("org")||
-1!=e.name.toLowerCase().indexOf("company"))||e.id&&(-1!=e.id.toLowerCase().indexOf("org")||-1!=e.id.toLowerCase().indexOf("company"))||e.id&&k[e.id]&&(-1!=k[e.id].toLowerCase().indexOf("org")||-1!=k[e.id].toLowerCase().indexOf("company")))i.organization||(i.organization=p),g=!0;else if(e.name&&-1!=e.name.toLowerCase().indexOf("name")||e.id&&-1!=e.id.toLowerCase().indexOf("name")||e.id&&k[e.id]&&-1!=k[e.id].toLowerCase().indexOf("name"))i.name||(i.name=""),i.name+=p+" ",g=!0}}g&&(m("Gathered user data",
i),c?b.user_details({custom:i}):b.user_details(i));b.end_session()}})}function d(){if("undefined"!==typeof a.getElementsByTagName)for(var b=a.getElementsByTagName("form"),c=0;c<b.length;c++)f(b[c]);else m("Can't track forms")}a=a||document;"complete"===document.readyState?d():k(window,"load",d)};b.collect_from_facebook=function(a){FB&&FB.api&&FB.api("/me",function(c){var f={};c.name&&(f.name=c.name);c.email&&(f.email=c.email);"male"==c.gender?f.gender="M":"female"==c.gender&&(f.gender="F");if(c.birthday){var d=
c.birthday.split("/").pop();d&&4==d.length&&(f.byear=d)}c.work&&(c.work[0]&&c.work[0].employer&&c.work[0].employer.name)&&(f.organization=c.work[0].employer.name);if(a){f.custom={};for(var j in a){for(var d=a[j].split("."),h=c,i=0;i<d.length&&!(h=h[d[i]],"undefined"===typeof h);i++);"undefined"!==typeof h&&(f.custom[j]=h)}}b.user_details(f)})};var k=function(a,b,f){"undefined"!==typeof a.addEventListener?a.addEventListener(b,f,!1):a.attachEvent("on"+b,f)},q=function(a,b,f){function d(a,b,c){var d=
new Date;d.setTime(d.getTime()+864E5*c);c="; expires="+d.toGMTString();document.cookie=a+"="+b+c+"; path=/"}var f=f||!1,j=!1,h;if("undefined"!==typeof localStorage){j=!0;try{localStorage.setItem("testLocal",!0)}catch(i){j=!1}}"undefined"!==typeof b&&null!==b&&("object"===typeof b&&(b=JSON.stringify(b)),j?localStorage.setItem(a,b):f||d(a,b,30));if("undefined"===typeof b){if(j)h=localStorage.getItem(a);else if(!f)a:{a+="=";b=document.cookie.split(";");f=0;for(j=b.length;f<j;f++){for(h=b[f];" "===h.charAt(0);)h=
h.substring(1,h.length);if(0===h.indexOf(a)){h=h.substring(a.length,h.length);break a}}h=null}try{h=JSON.parse(h)}catch(g){}return h}null===b&&(j?localStorage.removeItem(a):f||d(a,"",-1))}})(window.Countly=window.Countly||{});
