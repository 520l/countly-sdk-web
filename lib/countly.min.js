!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Countly=t():e.Countly=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var o,i,r;"undefined"!=typeof window&&window,i=[],void 0===(r="function"==typeof(o=function(){"use strict";var e,t,n,o={},i="18.04",r="javascript_native_web",a=!1,s=!1,c="/i",d=500,l=1e3,u=[],f=[],m=[],p={},v=[],g=null,_=!0,h=0,y=null,w=0,x=0,b=0,k=60,L=20,C=0,O=60,S=10,T=0,E=!0,N=!1,M={},A={},q=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,H=/(CountlySiteBot|nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO)/,P=!0;o.features=["sessions","events","views","scrolls","clicks","forms","crashes","attribution","users","star-rating","location"];for(var j,B={},I=0;I<o.features.length;I++)B[o.features[I]]={};o.init=function(e,t){if(!a&&(n=V(),a=!0,u=ue("cly_queue")||[],p={},f=ue("cly_event")||[],d=(e=e||{}).interval||o.interval||d,l=e.queue_size||o.queue_size||l,k=e.fail_timeout||o.fail_timeout||k,L=e.inactivity_time||o.inactivity_time||L,O=e.session_update||o.session_update||O,S=e.max_events||o.max_events||S,o.ignore_prefetch=e.ignore_prefetch||o.ignore_prefetch||!0,o.debug=e.debug||o.debug||!1,o.app_key=e.app_key||o.app_key||null,o.device_id=e.device_id||o.device_id||$(),o.url=te(e.url||o.url||""),o.app_version=e.app_version||o.app_version||"0.0",o.country_code=e.country_code||o.country_code||null,o.city=e.city||o.city||null,o.ip_address=e.ip_address||o.ip_address||null,o.ignore_bots=e.ignore_bots||o.ignore_bots||!0,o.force_post=e.force_post||o.force_post||!1,o.q=o.q||[],o.onload=o.onload||[],o.ignore_visitor=e.ignore_visitor||o.ignore_visitor||!1,o.require_consent=e.require_consent||o.require_consent||!1,e.ignore_referrers&&e.ignore_referrers.constructor===Array?v=e.ignore_referrers:o.ignore_referrers&&o.ignore_referrers.constructor===Array&&(v=o.ignore_referrers),""===o.url&&(U("Please provide server URL"),o.ignore_visitor=!0),ue("cly_ignore")&&(o.ignore_visitor=!0),o.ignore_prefetch&&void 0!==document.visibilityState&&"prerender"===document.visibilityState&&(o.ignore_visitor=!0),o.ignore_bots&&H.test(navigator.userAgent)&&(o.ignore_visitor=!0),window.name&&0===window.name.indexOf("cly:")?o.passed_data=JSON.parse(window.name.replace("cly:","")):location.hash&&0===location.hash.indexOf("#cly:")&&(o.passed_data=JSON.parse(location.hash.replace("#cly:",""))),o.passed_data&&o.passed_data.token&&o.passed_data.purpose&&(o.passed_data.token!=ue("cly_old_token")&&(de(o.passed_data.token),ue("cly_old_token",o.passed_data.token)),"heatmap"===o.passed_data.purpose&&(o.ignore_visitor=!0,me(),fe(o.url+"/views/heatmap.js",pe))),!o.ignore_visitor)){U("Countly initialized"),o.onload.constructor!==Array&&(o.onload=[]),o.q.constructor!==Array&&(o.q=[]),z(),ue("cly_id",o.device_id);var i=0;if(location.search){var r=location.search.substring(1).split("&");for(i=0;i<r.length;i++){var s=r[i].split("=");"cly_id"==s[0]?ue("cly_cmp_id",s[1]):"cly_uid"==s[0]&&ue("cly_cmp_uid",s[1])}}if(void 0!==o.onload&&o.onload.length>0){for(i=0;i<o.onload.length;i++)"function"==typeof o.onload[i]&&o.onload[i]();o.onload=[]}}},o.group_features=function(e){if(e)for(var t in e)B[t]?U("Feature name "+t+" is already reserved"):"string"==typeof e[t]?B[t]={features:[e[t]]}:e[t]&&e[t].constructor===Array&&e[t].length?B[t]={features:e[t]}:U("Incorrect feature list for "+t+" value: "+e[t]);else U("Incorrect features: "+e)},o.check_consent=function(e){return!(o.require_consent&&(B[e]?!B[e]||!B[e].optin:(U("No feature available for "+e),1)))},o.check_any_consent=function(){if(!o.require_consent)return!0;for(var e in B)if(B[feature]&&B[feature].optin)return!0;return!1},o.add_consent=function(e){if(U("Adding consent for "+e),e.constructor===Array)for(var t=0;t<e.length;t++)o.add_consent(e[t]);else B[e]?B[e].features?(B[e].optin=!0,o.add_consent(B[e].features)):!0!==B[e].optin&&(M[e]=!0,B[e].optin=!0,D(),setTimeout(function(){"sessions"===e&&A.begin_session?(o.begin_session.apply(o,A.begin_session),A.begin_session=null):"views"===e&&A.track_pageview&&(y=null,o.track_pageview.apply(o,A.track_pageview),A.track_pageview=null),A.change_id&&(o.change_id.apply(o,A.change_id),A.change_id=null)},1)):U("No feature available for "+e)},o.remove_consent=function(e){if(U("Removing consent for "+e),e.constructor===Array)for(var t=0;t<e.length;t++)o.remove_consent(e[t]);else B[e]?(B[e].features?o.remove_consent(B[e].features):!1!==B[e].optin&&(M[e]=!1,D()),B[e].optin=!1):U("No feature available for "+e)};var D=function(){j&&(clearTimeout(j),j=null),j=setTimeout(function(){le(M)&&(F({consent:JSON.stringify(M)}),M={})},1e3)};function R(e){if(!o.ignore_visitor)if(e.key){e.count||(e.count=1);var t=ne(e,["key","count","sum","dur","segmentation"]);t.timestamp=K();var n=new Date;t.hour=n.getHours(),t.dow=n.getDay(),f.push(t),ue("cly_event",f),U("Adding event: ",e)}else U("Event must have key property")}o.begin_session=function(t){if(o.check_consent("sessions")){if(!s){U("Session started"),e=V(),s=!0,_=!t;var n={begin_session:1};n.metrics=JSON.stringify(W()),F(n)}}else A.begin_session=arguments},o.session_duration=function(e){o.check_consent("sessions")&&s&&(U("Session extended",e),F({session_duration:e}))},o.end_session=function(t){o.check_consent("sessions")&&s&&(t=t||V()-e,U("Ending session"),Y(),s=!1,F({end_session:1,session_duration:t}))},o.change_id=function(e,t){if(o.device_id!=e){t||(o.end_session(),p={});var n=o.device_id;o.device_id=e,ue("cly_id",o.device_id),U("Changing id"),t?o.check_any_consent()?F({old_device_id:n}):A.change_id=arguments:o.begin_session(!_)}},o.add_event=function(e){o.check_consent("events")&&R(e)},o.start_event=function(e){p[e]?U("Timed event with key "+e+" already started"):p[e]=V()},o.end_event=function(e){"string"==typeof e&&(e={key:e}),e.key?p[e.key]?(e.dur=V()-p[e.key],o.add_event(e),delete p[e.key]):U("Timed event with key "+e.key+" was not started"):U("Event must have key property")},o.user_details=function(e){o.check_consent("users")&&(U("Adding userdetails: ",e),F({user_details:JSON.stringify(ne(e,["name","username","email","organization","phone","picture","gender","byear","custom"]))}))},o.report_conversion=function(e,t){o.check_consent("attribution")&&(e=e||ue("cly_cmp_id")||"cly_organic",t=t||ue("cly_cmp_uid"),e&&t?F({campaign_id:e,campaign_user:t}):e&&F({campaign_id:e}))};var J={},X=function(e,t,n){o.check_consent("users")&&(J[e]||(J[e]={}),"$push"==n||"$pull"==n||"$addToSet"==n?(J[e][n]||(J[e][n]=[]),J[e][n].push(t)):J[e][n]=t)};function Y(){if(y){var e={name:y,segment:t};o.check_consent("views")&&R({key:"[CLY]_view",dur:V()-w,segmentation:e}),y=null}}function F(e){if(!o.ignore_visitor)if(o.app_key&&o.device_id){e.app_key=o.app_key,e.device_id=o.device_id,e.sdk_name=r,e.sdk_version=i,o.check_consent("location")?(o.country_code&&(e.country_code=o.country_code),o.city&&(e.city=o.city),null!==o.ip_address&&(e.ip_address=o.ip_address)):e.location="",e.timestamp=K();var t=new Date;e.hour=t.getHours(),e.dow=t.getDay(),u.length>l&&u.shift(),u.push(e),ue("cly_queue",u,!0)}else U("app_key or device_id is missing")}function z(){if(o.ignore_visitor)N=!1;else{N=!0;var t=0;if(void 0!==o.onload&&o.onload.length>0){for(t=0;t<o.onload.length;t++)"function"==typeof o.onload[t]&&o.onload[t]();o.onload=[]}if(void 0!==o.q&&o.q.length>0){var n,i=o.q;for(o.q=[],t=0;t<i.length;t++)if(U("Processing queued call",n=i[t]),"function"==typeof n)n();else if(n.constructor===Array&&n.length>0)if(void 0!==o[n[0]])o[n[0]].apply(null,n.slice(1));else{var r=n[0].replace("userData.","");void 0!==o.userData[r]&&o.userData[r].apply(null,n.slice(1))}}if(s&&_&&P){var a=V();a-e>O&&(o.session_duration(a-e),e=a)}if(f.length>0){if(f.length<=S)F({events:JSON.stringify(f)}),f=[];else{var c=f.splice(0,S);F({events:JSON.stringify(c)})}ue("cly_event",f)}if(u.length>0&&E&&V()>b){E=!1;var l=u.shift();le(M)&&(j&&(clearTimeout(j),j=null),l.consent=JSON.stringify(M),M={}),U("Processing request",l),Z(l,function(e,t){U("Request Finished",t,e),e&&(u.unshift(t),b=V()+k),ue("cly_queue",u,!0),E=!0})}setTimeout(z,d)}}function $(){return ue("cly_id")||G()}function G(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t}function W(){var e={};if(e._app_version=o.app_version,e._ua=navigator.userAgent,screen.width){var t=screen.width?parseInt(screen.width):0,n=screen.height?parseInt(screen.height):0;if(0!==t&&0!==n){var i=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);if(i&&window.devicePixelRatio)t=Math.round(t*window.devicePixelRatio),n=Math.round(n*window.devicePixelRatio);else if(90===Math.abs(window.orientation)){var r=t;t=n,n=r}e._resolution=t+"x"+n}}window.devicePixelRatio&&(e._density=window.devicePixelRatio);var a=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;if(void 0!==a&&(e._locale=a),void 0!==document.referrer&&document.referrer.length){var s=q.exec(document.referrer);if(s&&s[11]&&s[11]!=window.location.hostname){var c=!1;if(v&&v.length)for(var d=0;d<v.length;d++)try{var l=new RegExp(v[d]);if(l.test(document.referrer)){U("Ignored:",document.referrer),c=!0;break}}catch(e){}c||(e._store=document.referrer)}}return U("Got metrics",e),e}function U(){o.debug&&"undefined"!=typeof console&&(arguments[1]&&"object"==typeof arguments[1]&&(arguments[1]=JSON.stringify(arguments[1])),console.log(Array.prototype.slice.call(arguments).join("\n")))}function V(){return Math.floor((new Date).getTime()/1e3)}function K(){var e=(new Date).getTime();return T>=e?T++:T=e,T}function Q(e,t,i){if(o.check_consent("crashes")&&e){i=i||g;var r="";"object"==typeof e?void 0!==e.stack?r=e.stack:(void 0!==e.name&&(r+=e.name+":"),void 0!==e.message&&(r+=e.message+"\n"),void 0!==e.fileName&&(r+="in "+e.fileName+"\n"),void 0!==e.lineNumber&&(r+="on "+e.lineNumber),void 0!==e.columnNumber&&(r+=":"+e.columnNumber)):r=e+"",t=!!t;var a=W(),s={_resolution:a._resolution,_error:r,_app_version:a._app_version,_run:V()-n,_not_os_specific:!0},c=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;c&&(s._bat=Math.floor(100*c.level)),void 0!==navigator.onLine&&(s._online=!!navigator.onLine),s._background=!document.hasFocus(),m.length>0&&(s._logs=m.join("\n")),m=[],s._nonfatal=t,s._view=(window.location.pathname||"")+(window.location.search||"")+(window.location.hash||""),void 0!==i&&(s._custom=i);try{var d=document.createElement("canvas"),l=d.getContext("experimental-webgl");s._opengl=l.getParameter(l.VERSION)}catch(e){}F({crash:JSON.stringify(s)})}}function Z(e,t){try{U("Sending XML HTTP request");var n=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null,i=ee(e),r="GET";i.length>=2e3?r="POST":o.force_post&&(r="POST"),"GET"===r?n.open("GET",o.url+c+"?"+i,!0):(n.open("POST",o.url+c,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded")),n.onreadystatechange=function(){4===this.readyState&&this.status>=200&&this.status<300?"function"==typeof t&&t(!1,e):4===this.readyState&&(U("Failed Server XML HTTP request",this.status),"function"==typeof t&&t(!0,e))},"GET"==r?n.send():n.send(i)}catch(n){U("Failed XML HTTP request",n),"function"==typeof t&&t(!0,e)}}function ee(e){var t=[];for(var n in e)t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}function te(e){return"/"==e.substr(e.length-1)?e.substr(0,e.length-1):e}function ne(e,t){for(var n,o={},i=0;i<t.length;i++)n=t[i],void 0!==e[n]&&(o[n]=e[n]);return o}o.userData={set:function(e,t){J[e]=t},set_once:function(e,t){X(e,1,"$setOnce")},increment:function(e){X(e,1,"$inc")},increment_by:function(e,t){X(e,t,"$inc")},multiply:function(e,t){X(e,t,"$mul")},max:function(e,t){X(e,t,"$max")},min:function(e,t){X(e,t,"$min")},push:function(e,t){X(e,t,"$push")},push_unique:function(e,t){X(e,t,"$addToSet")},pull:function(e,t){X(e,t,"$pull")},save:function(){o.check_consent("users")&&F({user_details:JSON.stringify({custom:J})}),J={}}},o.track_errors=function(e){g=e,window.onerror=function(e,t,n,o,i){if(void 0!==i)Q(i,!1);else{o=o||window.event&&window.event.errorCharacter;var r="";void 0!==e&&(r+=e+"\n"),void 0!==t&&(r+="at "+t),void 0!==n&&(r+=":"+n),void 0!==o&&(r+=":"+o),r+="\n";try{for(var a=[],s=arguments.callee.caller;s;)a.push(s.name),s=s.caller;r+=a.join("\n")}catch(e){}Q(r,!1)}}},o.log_error=function(e,t){Q(e,!0,t)},o.add_log=function(e){o.check_consent("crashes")&&m.push(e)},o.stop_time=function(){P&&(P=!1,h=V()-e,x=V()-w)},o.start_time=function(){P||(P=!0,e=V()-h,w=V()-x,x=0)},o.track_sessions=function(){o.begin_session(),o.start_time(),oe(window,"beforeunload",function(){o.end_session()}),oe(window,"unload",function(){o.end_session()});var e="hidden";function t(){document[e]?o.stop_time():o.start_time()}function n(){C>=L&&o.start_time(),C=0}e in document?document.addEventListener("visibilitychange",t):(e="mozHidden")in document?document.addEventListener("mozvisibilitychange",t):(e="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",t):(e="msHidden")in document?document.addEventListener("msvisibilitychange",t):"onfocusin"in document?(oe(window,"focusin",function(){o.start_time()}),oe(window,"focusout",function(){o.stop_time()})):(oe(window,"focus",function(){o.start_time()}),oe(window,"blur",function(){o.stop_time()}),oe(window,"pageshow",function(){o.start_time()}),oe(window,"pagehide",function(){o.stop_time()})),oe(window,"mousemove",n),oe(window,"click",n),oe(window,"keydown",n),oe(window,"scroll",n),setInterval(function(){++C>=L&&o.stop_time()},6e4)},o.track_pageview=function(e,t){if(Y(),e&&e.constructor===Array&&(t=e,e=null),e=e||window.location.pathname,t&&t.length)for(var n=0;n<t.length;n++)try{if(new RegExp(t[n]).test(e))return void U("Ignored:",e)}catch(e){}y=e,w=V();var i={name:e,visit:1,domain:window.location.hostname};if(void 0!==document.referrer&&document.referrer.length){var r=q.exec(document.referrer);r&&r[11]&&r[11]!=window.location.hostname&&(i.start=1)}o.check_consent("views")?R({key:"[CLY]_view",segmentation:i}):A.track_pageview=arguments},o.track_view=function(e,t){o.track_pageview(e,t)},o.track_clicks=function(e){e=e||document;var t=!0;oe(e,"click",function(e){if(t){if(t=!1,re(e),void 0!==e.pageX&&void 0!==e.pageY){var n=ae(),i=se();o.check_consent("clicks")&&R({key:"[CLY]_action",segmentation:{type:"click",x:e.pageX,y:e.pageY,width:i,height:n,domain:window.location.hostname,view:window.location.pathname}})}setTimeout(function(){t=!0},1e3)}})},o.track_scrolls=function(e){e=e||window;var t=!0,n=0;function i(e){if(t){t=!1;var i=ae(),r=se(),a=ce();o.check_consent("scrolls")&&R({key:"[CLY]_action",segmentation:{type:"scroll",y:n+a,width:r,height:i,domain:window.location.hostname,view:window.location.pathname}})}}oe(e,"scroll",function(e){n=Math.max(n,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)}),oe(e,"beforeunload",i),oe(e,"unload",i)},o.track_links=function(e){e=e||document,oe(e,"click",function(e){var t=ie(e).closest("a");t&&(re(e),o.check_consent("clicks")&&R({key:"linkClick",segmentation:{href:t.href,text:t.innerText,id:t.id,x:e.pageX,y:e.pageY,view:window.location.pathname}}),void 0===t.href||"_blank"===t.target||e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||0!==t.href.replace(window.location.href.split("#")[0],"").indexOf("#")&&o.end_session())})},o.track_forms=function(e){function t(e){return e.name||e.id||e.type||e.nodeName}e=e||document,oe(e,"submit",function(e){var n,i=ie(e),r={id:i.id,name:i.name,action:i.action,method:i.method,view:window.location.pathname};if(void 0!==i.elements){for(var a=0;a<i.elements.length;a++)if((n=i.elements[a])&&"password"!=n.type)if(void 0===r["input:"+t(n)]&&(r["input:"+t(n)]=[]),"select"==n.nodeName.toLowerCase())if(void 0!==n.multiple){var s=[];if(void 0!==n.options)for(var c=0;c<n.options.length;c++)n.options[c].selected&&s.push(n.options[c].value);r["input:"+t(n)].push(s.join(", "))}else r["input:"+t(n)].push(n.options[n.selectedIndex].value);else"input"==n.nodeName.toLowerCase()?void 0===n.type||"checkbox"!=n.type.toLowerCase()&&"radio"!=n.type.toLowerCase()?r["input:"+t(n)].push(n.value):n.checked&&r["input:"+t(n)].push(n.value):"textarea"==n.nodeName.toLowerCase()?r["input:"+t(n)].push(n.value):void 0!==n.value&&r["input:"+t(n)].push(n.value);for(var d in r)void 0!==r[d].join&&(r[d]=r[d].join(", "))}o.check_consent("forms")&&R({key:"formSubmit",segmentation:r}),o.end_session()})},o.collect_from_forms=function(e,t){e=e||document,oe(e,"submit",function(n){var i,r=ie(n),a={},s=!1;if(void 0!==r.elements){var c,d,l={},u=e.getElementsByTagName("LABEL");for(c=0;c<u.length;c++)u[c].htmlFor&&""!==u[c].htmlFor&&(l[u[c].htmlFor]=u[c].innerText||u[c].textContent||u[c].innerHTML);for(c=0;c<r.elements.length;c++)if((i=r.elements[c])&&"password"!=i.type&&-1==i.className.indexOf("cly_user_ignore")){var f="";if("select"==i.nodeName.toLowerCase())if(void 0!==i.multiple){var m=[];if(void 0!==i.options)for(d=0;d<i.options.length;d++)i.options[d].selected&&m.push(i.options[d].value);f=m.join(", ")}else f=i.options[i.selectedIndex].value;else"input"==i.nodeName.toLowerCase()?void 0===i.type||"checkbox"!=i.type.toLowerCase()&&"radio"!=i.type.toLowerCase()?f=i.value:i.checked&&(f=i.value):"textarea"==i.nodeName.toLowerCase()?f=i.value:void 0!==i.value&&(f=i.value);if(i.className&&-1!=i.className.indexOf("cly_user_")){var p=i.className.split(" ");for(d=0;d<p.length;d++)if(0===p[d].indexOf("cly_user_")){a[p[d].replace("cly_user_","")]=f,s=!0;break}}else i.type&&"email"==i.type.toLowerCase()||i.name&&-1!=i.name.toLowerCase().indexOf("email")||i.id&&-1!=i.id.toLowerCase().indexOf("email")||i.id&&l[i.id]&&-1!=l[i.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(f)?(a.email||(a.email=f),s=!0):i.name&&-1!=i.name.toLowerCase().indexOf("username")||i.id&&-1!=i.id.toLowerCase().indexOf("username")||i.id&&l[i.id]&&-1!=l[i.id].toLowerCase().indexOf("username")?(a.username||(a.username=f),s=!0):i.name&&(-1!=i.name.toLowerCase().indexOf("tel")||-1!=i.name.toLowerCase().indexOf("phone")||-1!=i.name.toLowerCase().indexOf("number"))||i.id&&(-1!=i.id.toLowerCase().indexOf("tel")||-1!=i.id.toLowerCase().indexOf("phone")||-1!=i.id.toLowerCase().indexOf("number"))||i.id&&l[i.id]&&(-1!=l[i.id].toLowerCase().indexOf("tel")||-1!=l[i.id].toLowerCase().indexOf("phone")||-1!=l[i.id].toLowerCase().indexOf("number"))?(a.phone||(a.phone=f),s=!0):i.name&&(-1!=i.name.toLowerCase().indexOf("org")||-1!=i.name.toLowerCase().indexOf("company"))||i.id&&(-1!=i.id.toLowerCase().indexOf("org")||-1!=i.id.toLowerCase().indexOf("company"))||i.id&&l[i.id]&&(-1!=l[i.id].toLowerCase().indexOf("org")||-1!=l[i.id].toLowerCase().indexOf("company"))?(a.organization||(a.organization=f),s=!0):(i.name&&-1!=i.name.toLowerCase().indexOf("name")||i.id&&-1!=i.id.toLowerCase().indexOf("name")||i.id&&l[i.id]&&-1!=l[i.id].toLowerCase().indexOf("name"))&&(a.name||(a.name=""),a.name+=f+" ",s=!0)}}s&&(U("Gathered user data",a),t?o.user_details({custom:a}):o.user_details(a)),o.end_session()})},o.collect_from_facebook=function(e){FB&&FB.api&&FB.api("/me",function(t){var n={};if(t.name&&(n.name=t.name),t.email&&(n.email=t.email),"male"==t.gender?n.gender="M":"female"==t.gender&&(n.gender="F"),t.birthday){var i=t.birthday.split("/").pop();i&&4==i.length&&(n.byear=i)}if(t.work&&t.work[0]&&t.work[0].employer&&t.work[0].employer.name&&(n.organization=t.work[0].employer.name),e)for(var r in n.custom={},e){for(var a=e[r].split("."),s=t,c=0;c<a.length&&void 0!==(s=s[a[c]]);c++);void 0!==s&&(n.custom[r]=s)}o.user_details(n)})},o.opt_out=function(){o.ignore_visitor=!0,ue("cly_ignore",!0)},o.opt_in=function(){ue("cly_ignore",!1),o.ignore_visitor=!1,o.ignore_prefetch&&void 0!==document.visibilityState&&"prerender"===document.visibilityState&&(o.ignore_visitor=!0),o.ignore_bots&&H.test(navigator.userAgent)&&(o.ignore_visitor=!0),o.ignore_visitor||N||z()},Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;for(e=e.toUpperCase();t;){if(t.nodeName.toUpperCase()==e)return t;t=t.parentElement}});var oe=function(e,t,n){void 0!==e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},ie=function(e){return e?void 0!==e.target?e.target:e.srcElement:window.event.srcElement};function re(e){return void 0===e.pageY&&"number"==typeof e.clientX&&document.documentElement&&(e.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),e}function ae(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function se(){var e=document;return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function ce(){var e=document;return Math.min(Math.min(e.body.clientHeight,e.documentElement.clientHeight),Math.min(e.body.offsetHeight,e.documentElement.offsetHeight),window.innerHeight)}function de(e){ue("cly_token",e)}function le(e){if(e)for(var t in e)return!0;return!1}var ue=function(e,t,n){n=n||!1;var o,i=!1;i=!0;try{"undefined"!=typeof localStorage&&localStorage.setItem("testLocal",!0)}catch(e){i=!1}if(void 0!==t&&null!==t&&("object"==typeof t&&(t=JSON.stringify(t)),i?localStorage.setItem(e,t):n||r(e,t,30)),void 0===t){i?o=localStorage.getItem(e):n||(o=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0,i=n.length;o<i;o++){for(var r=n[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}(e));try{o=JSON.parse(o)}catch(e){}return o}function r(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="; expires="+o.toGMTString();document.cookie=e+"="+t+i+"; path=/"}null===t&&(i?localStorage.removeItem(e):n||r(e,"",-1))};function fe(e,t){var n,o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",e),t&&(o.onreadystatechange=o.onload=function(){n||t(),n=!0}),document.getElementsByTagName("head")[0].appendChild(o)}function me(){var e=document.getElementById("cly-loader");if(!e){U("setting up loader");var t="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}",n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t)),n.appendChild(o),(e=document.createElement("div")).setAttribute("id","cly-loader"),document.body.appendChild(e)}e.style.display="block"}function pe(){var e=document.getElementById("cly-loader");e&&(e.style.display="none")}return o._internals={store:ue,getDocWidth:se,getDocHeight:ae,getViewportHeight:ce,get_page_coord:re,get_event_target:ie,add_event:oe,getProperties:ne,stripTrailingSlash:te,prepareParams:ee,sendXmlHttpRequest:Z,recordError:Q,getMsTimestamp:K,getTimestamp:V,log:U,getMetrics:W,generateUUID:G,getId:$,heartBeat:z,toRequestQueue:F,reportViewDuration:Y,loadJS:fe,loadCSS:function(e,t){var n,o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",e),t&&(o.onreadystatechange=o.onload=function(){n||t(),n=!0}),document.getElementsByTagName("head")[0].appendChild(o)},getLastView:function(){return y},setToken:de,getToken:function(){var e=ue("cly_token");return ue("cly_token",null),e},showLoader:me,hideLoader:pe,add_cly_events:R},o})?o.apply(t,i):o)||(e.exports=r)}])});